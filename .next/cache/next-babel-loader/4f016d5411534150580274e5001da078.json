{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Israel Oduguwa/Desktop/startup-server/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Israel Oduguwa/Desktop/startup-server/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { SET_USER, LOADING_UI, LOADING_USER, CLEAR_ERRORS, SET_ERRORS } from \"../Types\";\nimport axios from \"axios\";\nexport var createUser = function createUser(userData, Router) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: LOADING_UI\n              });\n              axios.post('https://us-central1-resume-builder-startup.cloudfunctions.net/api/createAccount', userData).then(function (res) {\n                console.log(res.data);\n                setAuthorizationHeader(res.data.firstIdToken);\n                storeSessionToken(res.data.refreshToken);\n                dispatch(getUserData());\n                dispatch({\n                  type: CLEAR_ERRORS\n                });\n                Router.push('/admin/profile');\n                dispatch(getUserData());\n              })[\"catch\"](function (err) {\n                console.log(err.response.data); // dispatch({\n                //  type: SET_ERRORS,\n                //  payload: err.response.data\n                // })\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var editUserDetails = function editUserDetails(userDetails) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch({\n                type: LOADING_USER\n              });\n              _context2.next = 3;\n              return axios.post('https://us-central1-resume-builder-startup.cloudfunctions.net/api/user', userDetails);\n\n            case 3:\n              res = _context2.sent;\n              dispatch(getUserData());\n              console.log(res.data); //   })\n              //   .catch((err) => console.log(err));\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}; //This will fetch all the user INfo from the DataBase\n\nexport var getUserData = function getUserData() {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              dispatch({\n                type: LOADING_USER\n              });\n              axios.get('https://us-central1-resume-builder-startup.cloudfunctions.net/api/user').then(function (res) {\n                dispatch({\n                  type: SET_USER,\n                  payload: res.data\n                });\n              })[\"catch\"](function (err) {\n                return console.log(err);\n              });\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n}; //This will refresh the acsess toekm\n\nexport var refreshIdToken = function refreshIdToken(sessionToken) {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return axios.post(\"https://securetoken.googleapis.com/v1/token?key=AIzaSyBoIyQqz_8yKUFxjJO7jqBZWEslC7je7U4\", {\n                grant_type: \"refresh_token\",\n                refresh_token: sessionToken\n              });\n\n            case 2:\n              res = _context4.sent;\n              console.log(res.data.access_token);\n              setAuthorizationHeader(res.data.access_token);\n              dispatch(getUserData()); // .catch((err) =>{\n              //     console.log(err)\n              // })\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n}; //Set the Authorizationheader for the Jwt token and user permisssio\n\nvar setAuthorizationHeader = function setAuthorizationHeader(token) {\n  var FBIdToken = \"Bearer \".concat(token);\n  localStorage.setItem('FBIdToken', FBIdToken);\n  axios.defaults.headers.common['Authorization'] = FBIdToken;\n};\n\nvar storeSessionToken = function storeSessionToken(sessionToken) {\n  var refreshToken = sessionToken;\n  localStorage.setItem('refreshToken', refreshToken);\n};\n\nexport var logoutUser = function logoutUser() {\n  return function (dispatch) {\n    localStorage.removeItem('FBIdToken');\n    localStorage.removeItem('refreshToken');\n    delete axios.defaults.headers.common['Authorization'];\n    dispatch({\n      type: SET_UNAUTHENTICATED\n    });\n  };\n}; // Update User ACcount","map":{"version":3,"sources":["C:/Users/Israel Oduguwa/Desktop/startup-server/Redux/Actions/userAction.js"],"names":["SET_USER","LOADING_UI","LOADING_USER","CLEAR_ERRORS","SET_ERRORS","axios","createUser","userData","Router","dispatch","type","post","then","res","console","log","data","setAuthorizationHeader","firstIdToken","storeSessionToken","refreshToken","getUserData","push","err","response","editUserDetails","userDetails","get","payload","refreshIdToken","sessionToken","grant_type","refresh_token","access_token","token","FBIdToken","localStorage","setItem","defaults","headers","common","logoutUser","removeItem","SET_UNAUTHENTICATED"],"mappings":"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","sourcesContent":["import { SET_USER, LOADING_UI, LOADING_USER, CLEAR_ERRORS, SET_ERRORS } from \"../Types\";\r\nimport axios from \"axios\";\r\n\r\nexport const createUser = ( userData, Router ) => async (dispatch) =>{\r\n    dispatch({type:LOADING_UI});\r\n    axios.post('https://us-central1-resume-builder-startup.cloudfunctions.net/api/createAccount', userData)\r\n    .then((res)=>{\r\n        console.log(res.data)\r\n        setAuthorizationHeader(res.data.firstIdToken);\r\n        storeSessionToken(res.data.refreshToken)\r\n        dispatch(getUserData());\r\n        dispatch({ type: CLEAR_ERRORS});\r\n        Router.push('/admin/profile');\r\n        dispatch(getUserData());\r\n    })\r\n    .catch((err) =>{\r\n        console.log(err.response.data)\r\n        // dispatch({\r\n        //  type: SET_ERRORS,\r\n        //  payload: err.response.data\r\n        // })\r\n     });\r\n}\r\nexport const editUserDetails = (userDetails) => async (dispatch) => {\r\n  dispatch({ type: LOADING_USER });\r\n  const res = await axios.post('https://us-central1-resume-builder-startup.cloudfunctions.net/api/user', userDetails)      \r\n        dispatch(getUserData());\r\n        console.log(res.data)\r\n    //   })\r\n    //   .catch((err) => console.log(err));\r\n  };\r\n\r\n//This will fetch all the user INfo from the DataBase\r\nexport const getUserData = () => async (dispatch) => {\r\n    dispatch({ type: LOADING_USER})\r\n  axios.get('https://us-central1-resume-builder-startup.cloudfunctions.net/api/user')     \r\n  .then((res) =>{\r\n      \r\n    dispatch({\r\n        type: SET_USER,\r\n        payload: res.data\r\n    })\r\n  })\r\n  .catch((err) => console.log(err))\r\n   \r\n}\r\n//This will refresh the acsess toekm\r\nexport const refreshIdToken = (sessionToken) => async (dispatch) =>{\r\n    const res = await axios.post(`https://securetoken.googleapis.com/v1/token?key=AIzaSyBoIyQqz_8yKUFxjJO7jqBZWEslC7je7U4`,\r\n    {\r\n        grant_type:\"refresh_token\",        \r\n        refresh_token:sessionToken\r\n    }\r\n    )    \r\n        console.log(res.data.access_token)\r\n        setAuthorizationHeader(res.data.access_token)\r\n        dispatch(getUserData());\r\n    \r\n    // .catch((err) =>{\r\n    //     console.log(err)\r\n    // })\r\n}\r\n//Set the Authorizationheader for the Jwt token and user permisssio\r\n\r\nconst setAuthorizationHeader = (token) => {\r\n    const FBIdToken = `Bearer ${token}`;\r\n    localStorage.setItem('FBIdToken', FBIdToken);\r\n    axios.defaults.headers.common['Authorization'] = FBIdToken;\r\n  };\r\nconst storeSessionToken = (sessionToken) =>{\r\n    const refreshToken = sessionToken;\r\n    localStorage.setItem('refreshToken', refreshToken)\r\n}\r\n\r\nexport const logoutUser = () => (dispatch) =>{\r\n    localStorage.removeItem('FBIdToken'); \r\n    localStorage.removeItem('refreshToken');\r\n    delete axios.defaults.headers.common['Authorization'];\r\n    dispatch({ type: SET_UNAUTHENTICATED });\r\n}\r\n\r\n// Update User ACcount\r\n\r\n"]},"metadata":{},"sourceType":"module"}